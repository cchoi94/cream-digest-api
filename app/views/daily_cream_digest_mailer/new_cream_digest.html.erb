<%# styles %>
<% col_style = "width: calc(100% / 5); text-align:left; padding: 8px 0" %>
<% red = "color: #cf2a42" %>
<% green = "color: #008344" %>


<!DOCTYPE html>
<html>
  <head>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type' />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@200;400;700&display=swap" rel="stylesheet">
    <style>
      *{
        font-family: 'Source Sans Pro', sans-serif;
        margin: 0;
        box-sizing: 'border-box'
      }
    </style>
  </head>
  <body>
  <div style="padding: 24px">
    <h3 style="margin-bottom: 24px">Morning<%= @user.first_name %></h3>
    <div style="display:flex; align-items:center; margin-bottom: 24px">
      <h1 style="margin-right: 16px; font-size: 24px">$<%= @total_equity %></h1>
      <p>P/L day 
        <span style="<%= @open_pnl > 0 ? green : red %>">
          <%=@open_pnl%>
        </span>
      </p>
    </div>
      <div class="positions-header" style="display: flex; align-items:center; justify-content:space-between">
          <p style="<%= col_style %>">Symbol</p>
          <p style="<%= col_style %>">Open qty</p>
          <p style="<%= col_style %>">Equity</p>
          <p style="<%= col_style %>">Avg price</p>
          <p style="<%= col_style %>">Open P/L</p>
      </div>
      <hr>
      <% if @stocks.present? %>
        <% @stocks.each do |st| %>
          <div class="stock-container" style="display: flex; align-items:center; justify-content:space-between">
            <p style="<%= col_style %>"><%= st.name.length > 4 ? st.name[0..4] : st.name %></p>
            <p style="<%= col_style %>"><%= (st.amount * 1).round(0) %></p>
            <p style="<%= col_style %>"><%= ((st.amount*st.price) * 1).round(2) %></p>
            <p style="<%= col_style %>"><%= (st.price * 1).round(2) %></p>
            <p style="<%= col_style %> ; <%= (st.open_pnl * 1) > 0 ? green : red %>"><%= (st.open_pnl * 1).round(2) %></p>
          </div>
      <hr>
        <% end %>
      <% end %>
      <% if @cryptocurrencies.present? %>
        <% @cryptocurrencies.each do |cc| %>
          <div class="cryptocurrency-container" style="display: flex; align-items:center; justify-content:space-between">
            <p style="<%= col_style %>"><%= cc.name %></p>
            <p style="<%= col_style %>"><%= (cc.amount * 1).round(0) %></p>
            <p style="<%= col_style %>"><%= ((cc.amount*cc.price) * 1).round(2) %></p>
            <p style="<%= col_style %>"><%= (cc.price * 1).round(2) %></p>
            <p style="<%= col_style %>; <%= (cc.open_pnl * 1) > 0 ? green : red %>"><%= (cc.open_pnl * 1).round(2) %></p>
          </div>
        <% end %>
      <% end %>
      <hr>
      <%= link_to "View on my dashboard", "https://creamdigest.com" %>
  </div>
  </body>
</html>
